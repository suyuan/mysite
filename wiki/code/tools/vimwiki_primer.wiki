%title Vimwiki入门教程

[[../../index|首页]] - [[../index|Code]] - [[index|Tools]]
==Vimwiki入门教程==
----
===引子===

两年前，我刚开始接触 `Vim` 时曾写过一篇 `Vimwiki` 的入门教程（`https://github.com/ruchee/backup2/blob/master/code/linux/vim/vimwiki_primer.wiki`）

只是那是基于 `1.x` 版本的，而且很多地方都没有细说，并不适合新手

今天闲来无事，重作一篇以回馈社区

顺便说一句，本博客所有页面均由 `Vimwiki` 生成
----
===使用前提===

# 熟悉 `Vim` 的基本命令 （这个必须有，如果不熟悉的话，先把 `Vim` 自带的 `tutor` 练习几遍吧，只需掌握最基本的几个命令即可）
# 喜欢用纯文本写日志 （没有此喜好的就不要用 `Vimwiki` 来虐自己了，各种开源博客系统遍地都是）
----
===本教程可以教你的===

# 搭建 `Vimwiki` 本地站点
# 用 `Vimwiki` 写日志
# 用 `Vimwiki` 写博客
# 使用免费的 `Github Pages` 托管静态页面
----
===安装Vimwiki===

`Vim` 的基础知识以及基本概念这儿就不提了，下面是安装步骤：

`1`、`Vim` 肯定是必须的啦，`Windows` 可以安装 `gVim`（`Vim` 官网被墙，可上 `http://vim.wendal.net/download.php#pc` 下载），`Linux` 用各种包管理系统搞定

`2`、上 `https://github.com/vimwiki/vimwiki/releases` 下载最新的版本，将其拷贝到 `vimfiles` 目录下（`Linux` 为 `~/.vim`）<br/>
如果你使用的是 `pathogen` 包管理器，则拷贝到 `vimfiles/bundle/vimwiki` 路径下（`Linux` 为 `~/.vim/bundle/vimwiki`）

`3`、将以下语句写入你的 `_vimrc` 文件（`Linux` 为 `.vimrc`）
{{{class="brush: vim"

" ======= 通用配置 ======
set nocompatible   " 关闭兼容模式
filetype plugin on " 针对不同的文件类型加载对应的插件
syntax on          " 开启文件类型侦测

" ======= 判断操作系统类型 =======
if(has("win32") || has("win64"))
    let g:isWIN = 1
else
    let g:isWIN = 0
endif

" ======= Vimwiki =======

let g:vimwiki_w32_dir_enc='utf-8' " 设置编码
let g:vimwiki_use_mouse=1         " 使用鼠标映射

" 声明可以在wiki里面使用的HTML标签
let g:vimwiki_valid_html_tags = 'a,img,b,i,s,u,sub,sup,br,hr,div,del,code,red,center,left,right,h1,h2,h3,h4,h5,h6,pre,script,style'

" 创建站点
let blog = {}
if g:isWIN
    let blog.path          = 'D:/Ruchee/Files/mysite/wiki/'
    let blog.path_html     = 'D:/Ruchee/Files/mysite/html/'
    let blog.template_path = 'D:/Ruchee/Files/mysite/templates/'
else
    let blog.path          = '~/mysite/wiki/'
    let blog.path_html     = '~/mysite/html/'
    let blog.template_path = '~/mysite/templates/'
endif
let blog.template_default  = 'site'
let blog.template_ext      = '.html'
let blog.auto_export       = 1

" 加载站点
let g:vimwiki_list = [blog]
}}}

下面是针对上述配置的简要说明
* `let g:isWIN = x`：这是用来自动判断操作系统的，这对经常在 `Windows` 和 `Linux` 之间游弋的人来说（譬如我），就不需要频繁地去修改各个配置了
* `let g:vimwiki_valid_html_tags`：声明不需要 `Vimwiki` 编译的 `HTML` 标签
* `let xxx = {}`：创建一个 `wiki` 站点，`xxx` 这个名字你可以自己随意定义
* `let xxx.path`：指定 `wiki` 源文件的存放目录（因为 `Vimwiki` 就相当于一个编译器，它将其自己的语法翻译成 `HTML` 代码）
* `let xxx.path_html`：指定编译后的 `HTML` 页面存放的目录
* `let xxx.template_path`：指定模板文件的存放目录
* `let xxx.template_default`：指定默认模板，不需要写后缀
* `let xxx.template_ext`：指定模板文件的后缀（知道为什么 `let xxx.template_default` 不需要写后缀了吧）
* `let xxx.auto_export=1`：在保存源文件时自动编译，如果不希望自动编译，可将其设为 `0`
* `let g:vimwiki_list = [xxx]`：告诉 `Vimwiki` 你需要加载哪些站点，这也就是说，你可以建立多个站哦

上面是所展示的内容是从我自己的配置文件里面摘录出来的，你自己则需要根据所使用的操作系统平台（`Windows` or `Linux`）建立相应的文件夹（`wiki`、`html`、`templates`），并将上述配置里面的路径替换成你自己本机的实际路径（有点绕是吧？但应该不影响理解，你懂就行）
----
===小试牛刀===

访问 `https://github.com/ruchee/mysite`，将这个项目整个 `copy` 下来（会 `Git` 的我就不多说了，不会 `Git` 的右侧有 `Download ZIP` 按钮）

这是我博客的全部源代码，如果你想马上看一看 `Vimwiki` 到底是怎么工作的，那就按下面的步骤来吧：
# 将上一小节的配置原封不动地拷贝到你的 `_vimrc`（`Linux` 为 `.vimrc`）
# 如果你用的是 `Windows`，则新建 `D:\Ruchee\Files\mysite` 目录；如果你用的是 `Linux`，则新建 `~/mysite` 目录
# 将我博客的 `public`、`templates`、`wiki` 这三个目录全部拷贝到你刚建的 `mysite` 目录下，并新建一个 `html` 文件夹
# 进入 `wiki` 目录，使用 `Vim` 打开 `index.wiki` 文件
# 在命令模式下键入 `:VimwikiAll2HTML`，然后回车，你会看到 `Vimwiki` 已经在开始编译了
# 等编译完成，进入 `html` 目录，用浏览器打开 `index.html` 文件，然后，然后你就会看到我博客跑在你自己的电脑上啦。哇哇哇，多神奇
----
===基础讲解===

学编程的都知道，看代码+写代码永远是进步最快的学习方式，`Vimwiki` 也一样，你可以一边参考我博客 `wiki` 文件的写法，一边自己实践

* 本教程对应的 `wiki` 源文件在线浏览地址：<a href="https://raw.github.com/ruchee/mysite/master/wiki/code/tools/vimwiki_primer.wiki" target="_blank">https://raw.github.com/ruchee/mysite/master/wiki/code/tools/vimwiki_primer.wiki</a>
* 与本教程匹配的 `Vim` 配置在线浏览地址：<a href="https://raw.github.com/ruchee/vim/master/_vimrc" target="_blank">https://raw.github.com/ruchee/vim/master/_vimrc</a>

`Vimwiki` 只是个标记转换器，最终将转换成 `HTML` 代码，默认使用的是一种和 `Markdown` 类似的标记语言，但更好用（也许是用习惯了，我对 `Markdown` 可以说是丝毫无爱）

（`Vimwiki` 现在也支持用 `Markdown` 来写作了，只需将站点的配置项设置成下面的形式即可）：
{{{class="brush: vim"
let blog        = {}
let blog.syntax = 'markdown'
let blog.ext    = '.md'
" .... 其他配置
let g:vimwiki_list = [blog]
}}}

下面是我最常用的几个标签，余者请参考安装包自带的官方文档（下面的绝大部分内容援引自上一版本的教程，人懒了啊，没办法。。）
* `%title xxxx`：设定页面的标题，如本页面顶部的 `%title Vimwiki入门教程`
* `==二级标题==`：二级标题，我一般用来标识文章标题（如果行首空一个空格则会居中，适用于所有标题标签），如本页面头部的 `==Vimwiki入门教程==`
* `===三级标题===`：三级标题，我一般用来标识文章里面的各个子标题
* `======六级标题====`：六级标签，我用来标记时间（标题标签共 `6` 个，对应于等于号的个数，六级标签字体最小，一级标签字体最大）
* `[[链接地址|链接标题]]`：这主要用来链接本地文件，如本页首部的 `首页 - Code - Tools`，其对应写法为 `[[../../index|首页]] - [[../index|Code]] - [[index|Tools]]`
* `[链接地址 链接标题]`：这主要用来贴链接，如我想贴个`Google`首页的链接可以这样写 `[http://www.google.com Google]`，不过这个标签我基本上没怎么用过，因为都没几个外部链接
* `[[转向地址|图片地址]]`：本博简介页面的头像是这样写的`[[index.html|images/ruchee.jpg]]`，这样就会显示对应的图片，而点击图片就会转到首页。如果不需要转向，直接写`[[图片地址]]`即可
* `----`：四条小横线相当于`< hr >`标签，会出现一条本博客到处可见的横线
* `{{ { 程序代码或不需要编译的内容 } }}`：三个大括号用来书写程序代码或其他不想被编译的内容。注意，为了防止这些演示标签生效，我加上了空格，实际使用时不要留空格
* `两个反斜点`（这儿不便写演示代码，反斜点一般位于数字键1的左边）：相当于`< code >`与`< /code >`标签，显示效果就是本页随处可见的绿色荧光字
----
<red>date</red> : 2013-08-14
----
